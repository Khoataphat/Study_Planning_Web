<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>My Schedules</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="stylesheet" href="/resources/css/style.css">
</head>
<body>
    <div class="background-anim"><div class="shape"></div><div class="shape"></div><div class="shape"></div></div>

    <div class="app-container">
        <nav class="sidebar glass-style">
            <div class="sidebar-header"><div class="profile-avatar"><i class="fa-solid fa-user"></i></div></div>
            <ul class="sidebar-nav">
                <li><a href="/views/home.html"><i class="fa-solid fa-table-cells-large"></i> Dashboard</a></li>
                <li><a href="/views/schedules.html" style="color: #00d2ff; background: rgba(255,255,255,0.2);"><i class="fa-solid fa-calendar-days"></i> My Schedule</a></li>
                <li><a href="/views/tasks.html"><i class="fa-solid fa-list-check"></i> Tasks</a></li>
                <li><a href="#"><i class="fa-solid fa-chart-pie"></i> Analytics</a></li>
                <li><a href="#"><i class="fa-solid fa-brain"></i> AI Suggest</a></li>
            </ul>
        </nav>

        <main class="main-content">
            <header class="main-header glass-style">
                <h2>All Schedules</h2>
                <div style="flex:1"></div>
                <a href="/logout" class="icon-button"><i class="fa-solid fa-arrow-right-from-bracket"></i></a>
            </header>

            <div class="schedule-list" id="scheduleListContainer">
                
                <a href="/views/designer.html?id=new" class="schedule-card glass-style card-add-new">
                    <i class="fa-solid fa-plus-circle" style="font-size: 3rem; margin-bottom: 10px;"></i>
                    <span>Create New Schedule</span>
                </a>

                </div>
            </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', loadSchedules);

        function loadSchedules() {
            const container = document.getElementById('scheduleListContainer');
            const schedules = JSON.parse(localStorage.getItem('schedules')) || [];
            
            // Render các lịch đã lưu
            schedules.forEach(schedule => {
                const card = document.createElement('a');
                card.href = `/views/designer.html?id=${schedule.id}`; // Truyền ID lịch để chỉnh sửa
                card.classList.add('schedule-card', 'glass-style');
                card.innerHTML = `
                    <h3><i class="fa-solid fa-calendar-alt"></i> ${schedule.name}</h3>
                    <p>Tasks: ${schedule.taskCount || 0}</p>
                    <div style="margin-top: 10px; font-size: 0.8rem; color: #00d2ff;">
                        Click to Edit
                    </div>
                `;
                // Chèn ngay sau nút 'Create New'
                container.appendChild(card); 
            });

            if (schedules.length === 0) {
                 // Tạo lịch mẫu nếu chưa có
                const defaultSchedule = { 
                    id: Date.now(), 
                    name: 'Default Semester Schedule', 
                    taskCount: 5,
                    data: [] // Lịch rỗng
                };
                schedules.push(defaultSchedule);
                localStorage.setItem('schedules', JSON.stringify(schedules));
                loadSchedules(); // Tải lại để hiển thị lịch mẫu
            }
        }
    </script>
</body>
</html>